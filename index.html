<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Reveal Builder — Lightweight Animation Engine</title>
<style>
  :root{
    --bg:#0b1220;--panel:#141c2b;--muted:#9fb0c7;--text:#e6edf6;
    --accent:#22c55e;--accent2:#3b82f6;--border:#243047;--code:#0b1220;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Inter,Arial}
  .layout{display:flex;min-height:100vh}
  aside{width:400px;background:var(--panel);border-right:1px solid var(--border);padding:22px;display:flex;flex-direction:column;gap:16px}
  h1{margin:0 0 8px;font-size:18px;color:var(--muted);font-weight:700;letter-spacing:.3px}
  .group{display:grid;gap:8px}
  label{font-size:12px;color:#c7d3e5;font-weight:600}
  select,input,textarea{
    background:#101829;color:var(--text);border:1px solid var(--border);
    border-radius:8px;padding:10px 12px;font-size:14px;outline:none
  }
  input[type="number"]{appearance:textfield}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .actions{display:grid;gap:8px;margin-top:6px}
  button{
    background:var(--accent);color:#08111f;font-weight:800;border:0;padding:10px 12px;
    border-radius:9px;cursor:pointer;transition:transform .06s ease,opacity .2s ease
  }
  button:hover{opacity:.95} button:active{transform:translateY(1px)}
  .is-outline{background:transparent;color:var(--text);border:1px solid var(--border)}
  .is-blue{background:var(--accent2);color:#fff}
  main{flex:1;display:flex;align-items:center;justify-content:center;padding:28px}
  .preview{
    width:min(920px,100%);background:var(--panel);border:1px solid var(--border);border-radius:16px;
    padding:32px;min-height:300px;box-shadow:0 10px 30px rgba(0,0,0,.25)
  }
  .preview h2{margin:0 0 16px;color:#cfe0ff;font-size:16px;opacity:.9}
  .preview-text{
    background:#0e1729;border:1px dashed #2b3a57;color:#cfe0ff;padding:24px;border-radius:12px;
    font-size:2.25rem;line-height:1.25;letter-spacing:.2px
  }

  /* modal */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);padding:20px;z-index:10}
  .sheet{width:min(980px,100%);background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:18px}
  .tabs{display:flex;gap:16px;border-bottom:1px solid var(--border);margin-bottom:10px}
  .tab{padding:8px 2px;cursor:pointer;color:#b7c6da;font-weight:700}
  .tab.is-active{color:var(--accent);border-bottom:2px solid var(--accent)}
  pre{background:var(--code);color:#d0e2ff;border:1px solid var(--border);border-radius:10px;padding:12px;overflow:auto;font-size:13px;line-height:1.5;max-height:60vh}
  .toolbar{display:flex;gap:8px;justify-content:flex-end;margin:8px 0 14px}
  .badge{display:inline-flex;gap:8px;align-items:center;font-size:12px;color:#9fb0c7}
  code.inline{background:#0e1628;border:1px solid var(--border);padding:1px 6px;border-radius:6px}
</style>
</head>
<body>
  <div class="layout">
    <aside>
      <div>
        <h1>Reveal — Builder</h1>

        <div class="group">
          <label>Animation Type</label>
          <select class="js-animType">
            <option value="fade">fade</option>
            <option value="slide">slide</option>
            <option value="scale">scale</option>
            <option value="rotate">rotate</option>
            <option value="bounce">bounce</option>
            <option value="blur">blur</option>
            <option value="clip">clip</option>
            <option value="underline">underline</option>
            <option value="shine">shine</option>
            <option value="desat">desat</option>
            <option value="type">type</option>
            <option value="scramble">scramble</option>
          </select>
        </div>

        <div class="row">
          <div class="group">
            <label>Mode</label>
            <select class="js-mode">
              <option value="element">element</option>
              <option value="word" selected>word</option>
              <option value="char">char</option>
            </select>
          </div>
          <div class="group">
            <label>Direction</label>
            <select class="js-direction">
              <option value="up">up</option><option value="down">down</option>
              <option value="left">left</option><option value="right">right</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="group">
            <label>Duration (ms)</label>
            <input class="js-duration" type="number" min="60" max="8000" value="700" />
          </div>
          <div class="group">
            <label>Stagger (ms)</label>
            <input class="js-stagger" type="number" min="0" max="1500" value="90" />
          </div>
        </div>

        <div class="row">
          <div class="group">
            <label>Easing (CSS)</label>
            <select class="js-ease">
              <option>ease-out</option><option>ease-in</option><option>ease-in-out</option><option>linear</option>
              <option value="cubic-bezier(0.16, 1, 0.3, 1)">springy</option>
              <option value="cubic-bezier(0.22, 1, 0.36, 1)">expo-out</option>
            </select>
          </div>
          <div class="group">
            <label>Amount (px/deg/%)*</label>
            <input class="js-amount" type="number" value="80" />
          </div>
        </div>

        <div class="row">
          <div class="group">
            <label>Stagger Pattern</label>
            <select class="js-pattern">
              <option value="sequential">sequential</option>
              <option value="reverse">reverse</option>
              <option value="centerOut">centerOut</option>
              <option value="random">random</option>
            </select>
          </div>
          <div class="group">
            <label>Exit Animation</label>
            <select class="js-exit">
              <option value="none">none</option>
              <option value="fadeOut">fadeOut</option>
              <option value="slideOut">slideOut</option>
              <option value="shrinkOut">shrinkOut</option>
              <option value="dissolveOut">dissolveOut</option>
            </select>
          </div>
        </div>

        <div class="group">
          <label>Exit Delay (ms)</label>
          <input class="js-exitDelay" type="number" value="0" />
        </div>

        <div class="group">
          <label>Preview Text</label>
          <textarea class="js-text" rows="2">Building lightweight animation libraries is fun and fast</textarea>
        </div>

        <div class="actions">
          <button class="js-preview is-outline">Preview</button>
          <button class="js-generate is-blue">Generate Code</button>
        </div>
      </div>

      <div class="badge">
        <span>Engine: <code class="inline">reveal</code> · No deps · Vanilla JS</span>
      </div>
    </aside>

    <main>
      <div class="preview">
        <h2>Preview</h2>
        <div class="preview-text js-previewText">
          Building lightweight animation libraries is fun and fast
        </div>
      </div>
    </main>
  </div>

  <!-- Modal -->
  <div class="modal js-modal" role="dialog" aria-modal="true">
    <div class="sheet">
      <div class="tabs">
        <div class="tab is-active js-tab" data-tab="js">JS</div>
        <div class="tab js-tab" data-tab="css">CSS</div>
        <div class="tab js-tab" data-tab="how">How-to</div>
      </div>

      <div class="toolbar">
        <button class="is-outline js-copy">Copy</button>
        <button class="is-outline js-close">Close</button>
      </div>

      <pre class="js-content"></pre>
    </div>
  </div>

  <script>
  /* ================
     Preview helpers
     ================ */
  const $ = (sel, root=document)=> root.querySelector(sel);
  const $$ = (sel, root=document)=> Array.from(root.querySelectorAll(sel));

  const ui = {
    type: $('.js-animType'),
    mode: $('.js-mode'),
    direction: $('.js-direction'),
    duration: $('.js-duration'),
    stagger: $('.js-stagger'),
    ease: $('.js-ease'),
    amount: $('.js-amount'),
    pattern: $('.js-pattern'),
    exit: $('.js-exit'),
    exitDelay: $('.js-exitDelay'),
    text: $('.js-text'),
    previewText: $('.js-previewText'),
    btnPreview: $('.js-preview'),
    btnGenerate: $('.js-generate'),
    modal: $('.js-modal'),
    modalContent: $('.js-content'),
    modalCopy: $('.js-copy'),
    modalClose: $('.js-close'),
    modalTabs: $$('.js-tab')
  };

  function buildClassListFromUI(){
    const cls = [];
    // type
    cls.push(`reveal-${ui.type.value}`);
    // mode
    if(ui.mode.value === 'word') cls.push('reveal-word');
    else if(ui.mode.value === 'char') cls.push('reveal-char');
    // direction
    cls.push(`reveal-${ui.direction.value}`);
    // pattern
    if(ui.pattern.value === 'random') cls.push('reveal-random');
    else if(ui.pattern.value === 'centerOut') cls.push('reveal-center');
    // exit is not a class; provided as data attribute
    return cls.join(' ');
  }

  function applyPreview(){
    // set text
    ui.previewText.textContent = ui.text.value;

    // build class list
    const classes = buildClassListFromUI();
    ui.previewText.setAttribute('class', `preview-text js-previewText ${classes}`);

    // set data overrides
    ui.previewText.setAttribute('data-reveal-duration', ui.duration.value);
    ui.previewText.setAttribute('data-reveal-stagger', ui.stagger.value);
    ui.previewText.setAttribute('data-reveal-ease', ui.ease.value);
    ui.previewText.setAttribute('data-reveal-amount', ui.amount.value);
    ui.previewText.setAttribute('data-reveal-exit', ui.exit.value);
    ui.previewText.setAttribute('data-reveal-exit-delay', ui.exitDelay.value);

    // run preview using inline engine clone (minimal)
    revealPreviewInit();
  }

  ui.btnPreview.addEventListener('click', applyPreview);
  window.addEventListener('load', applyPreview);

  /* ==================================================
     Minimal inline engine for preview (no scroll trigger)
     (The generated JS has the full engine; this is light)
     ================================================== */
  function revealPreviewInit(){
    const qAll = (sel, root=document)=> Array.from(root.querySelectorAll(sel));
    const set = (el, styles)=>{for(const k in styles) el.style[k]=styles[k]};
    const px = n=> typeof n==='number'? `${n}px` : n;
    const has = (el, c)=> el.classList.contains(c);

    const splitters = {
      element: el=>[el],
      word: el=>{
        const words = el.textContent.trim().split(/\s+/);
        el.innerHTML = words.map(w=>`<span class="reveal-word">${w}</span>`).join(' ');
        return qAll('.reveal-word', el);
      },
      char: el=>{
        const chars = el.textContent.replace(/\s+/g,' ').split('');
        el.innerHTML = chars.map(c=> c===' ' ? ' ' : `<span class="reveal-char">${c}</span>`).join('');
        return qAll('.reveal-char', el);
      }
    };

    function readConfig(el){
      const type =
        has(el,'reveal-fade') ? 'fade' :
        has(el,'reveal-slide') ? 'slide' :
        has(el,'reveal-scale') ? 'scale' :
        has(el,'reveal-rotate')? 'rotate' :
        has(el,'reveal-bounce')? 'bounce' :
        has(el,'reveal-blur')  ? 'blur' :
        has(el,'reveal-clip')  ? 'clip' :
        has(el,'reveal-underline')? 'underline' :
        has(el,'reveal-shine') ? 'shine' :
        has(el,'reveal-desat') ? 'desat' :
        has(el,'reveal-type')  ? 'type' :
        has(el,'reveal-scramble') ? 'scramble' : 'fade';

      const mode = has(el,'reveal-char') ? 'char' : has(el,'reveal-word') ? 'word' : 'element';
      const direction = has(el,'reveal-down') ? 'down' : has(el,'reveal-left') ? 'left' : has(el,'reveal-right') ? 'right' : 'up';
      const pattern = has(el,'reveal-center') ? 'centerOut' : has(el,'reveal-random') ? 'random' : 'sequential';

      const num = (k, def)=> isNaN(+el.getAttribute(k)) ? def : +el.getAttribute(k);
      const str = (k, def)=> el.getAttribute(k) ?? def;

      return {
        type, mode, direction, pattern,
        duration: num('data-reveal-duration', 700),
        stagger : num('data-reveal-stagger', 90),
        ease    : str('data-reveal-ease', 'ease-out'),
        amount  : num('data-reveal-amount', 80),
        exit    : str('data-reveal-exit', 'none'),
        exitDelay: num('data-reveal-exit-delay', 0)
      };
    }

    const orderers = {
      sequential: arr=> arr.map((_,i)=>i),
      random: arr=> arr.map((_,i)=>i).sort(()=>Math.random()-0.5),
      centerOut: arr=>{
        const n=arr.length, c=(n-1)/2;
        return arr.map((_,i)=>[Math.abs(i-c),i]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);
      }
    };

    const FX = {
      fade:{prep:(el,c)=>set(el,{opacity:'0'}), play:(el,c)=>set(el,{transition:`opacity ${c.duration}ms ${c.ease}`,opacity:'1'})},
      slide:{
        prep:(el,c)=>{const m=c.amount;const map={up:`translateY(${px(m)})`,down:`translateY(-${px(m)})`,left:`translateX(${px(m)})`,right:`translateX(-${px(m)})`};set(el,{opacity:'0',transform:map[c.direction]||map.up});},
        play:(el,c)=>set(el,{transition:`transform ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease}`,transform:'translate(0,0)',opacity:'1'})
      },
      scale:{prep:(el,c)=>set(el,{opacity:'0',transform:'scale(0.85)'}), play:(el,c)=>set(el,{transition:`transform ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease}`,transform:'scale(1)',opacity:'1'})},
      rotate:{prep:(el,c)=>set(el,{opacity:'0',transform:`rotate(${px(c.amount)}deg)`}), play:(el,c)=>set(el,{transition:`transform ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease}`,transform:'rotate(0)',opacity:'1'})},
      bounce:{prep:(el,c)=>set(el,{opacity:'0',transform:'translateY(28px) scale(0.98)'}), play:(el,c)=>set(el,{transition:`transform ${c.duration}ms cubic-bezier(0.22,1,0.36,1),opacity ${c.duration}ms ${c.ease}`,transform:'translateY(0) scale(1)',opacity:'1'})},
      blur:{prep:(el,c)=>set(el,{opacity:'0',filter:'blur(6px)',transform:'translateY(8px)'}), play:(el,c)=>set(el,{transition:`filter ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease},transform ${c.duration}ms ${c.ease}`,filter:'blur(0)',opacity:'1',transform:'translateY(0)'})},
      clip:{
        prep:(el,c)=>{el.style.overflow='hidden';el.style.position='relative';const axis=(c.direction==='left'||c.direction==='right')?'X':'Y';const wrap=document.createElement('span');wrap.style.display='inline-block';wrap.style.clipPath=axis==='X'?'inset(0 100% 0 0)':'inset(100% 0 0 0)';wrap.append(...Array.from(el.childNodes));el.appendChild(wrap);el.__clip=wrap;},
        play:(el,c)=>{const w=el.__clip;if(!w)return;w.style.transition=`clip-path ${c.duration}ms ${c.ease}`;w.style.clipPath='inset(0 0 0 0)';}
      },
      underline:{
        prep:(el,c)=>{el.style.position='relative';const u=document.createElement('span');Object.assign(u.style,{position:'absolute',left:0,right:0,bottom:'-2px',height:'2px',background:'currentColor',transform:'scaleX(0)',transformOrigin:'left',opacity:'.9'});u.className='__underline';el.appendChild(u);},
        play:(el,c)=>{const u=el.querySelector('.__underline');if(u){u.style.transition=`transform ${c.duration}ms ${c.ease}`;u.style.transform='scaleX(1)';}}
      },
      shine:{
        prep:(el,c)=>{el.style.position='relative';el.style.overflow='hidden';const g=document.createElement('span');Object.assign(g.style,{position:'absolute',top:0,bottom:0,width:'80px',background:'linear-gradient(120deg,transparent,rgba(255,255,255,.35),transparent)',transform:'translateX(-120%)'});g.className='__shine';el.appendChild(g);},
        play:(el,c)=>{const g=el.querySelector('.__shine');if(g){g.style.transition=`transform ${c.duration}ms ${c.ease}`;g.style.transform='translateX(180%)';}}
      },
      desat:{prep:(el,c)=>set(el,{filter:'saturate(0) contrast(0.9) brightness(1.05)',opacity:'.7'}), play:(el,c)=>set(el,{transition:`filter ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease}`,filter:'saturate(1) contrast(1) brightness(1)',opacity:'1'})},
      type:{
        prep:(el,c)=>{const t=el.textContent;el.textContent='';el.__tw=t;const cur=document.createElement('span');cur.textContent='▍';cur.className='reveal-cursor';el.appendChild(cur);},
        play:async(el,c)=>{const t=el.__tw||'';const holder=document.createTextNode('');el.firstChild.before(holder);const tick=()=>new Promise(r=>requestAnimationFrame(r));for(let i=0;i<t.length;i++){holder.textContent+=t[i];await tick();if(c.stagger>0)await new Promise(r=>setTimeout(r,Math.max(0,c.stagger/4)));}const cur=el.querySelector('.reveal-cursor');cur&&cur.remove();}
      },
      scramble:{
        prep:(el,c)=>{const fin=el.textContent;el.textContent='';const pool="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@$%#";const spans=fin.split('').map(ch=>{const s=document.createElement('span');s.textContent=ch===' ' ? ' ' : '';s.dataset.final=ch;s.style.display='inline-block';s.style.minWidth='0.5ch';return s});spans.forEach(s=>el.appendChild(s));el.__scr=spans;el.__pool=pool;},
        play:async(el,c)=>{const d=c.duration,steps=Math.max(8,Math.floor(d/50));for(let k=0;k<steps;k++){el.__scr.forEach(s=>{if(s.dataset.final===' ')return;s.textContent=Math.random()<(k/steps)?s.dataset.final:el.__pool[Math.floor(Math.random()*el.__pool.length)]});await new Promise(r=>setTimeout(r,Math.max(16,d/steps)))}el.__scr.forEach(s=>s.textContent=s.dataset.final);}
      }
    };

    const EXITS = {
      none:{play(){}},
      fadeOut:{play:(el,c)=>set(el,{transition:`opacity ${c.duration}ms ${c.ease}`,opacity:'0'})},
      slideOut:{play:(el,c)=>{const m=c.amount;const map={up:`translateY(-${px(m)})`,down:`translateY(${px(m)})`,left:`translateX(-${px(m)})`,right:`translateX(${px(m)})`};set(el,{transition:`transform ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease}`,transform:map[c.direction]||map.up,opacity:'0'})}},
      shrinkOut:{play:(el,c)=>set(el,{transition:`transform ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease}`,transform:'scale(0.85)',opacity:'0'})},
      dissolveOut:{play:(el,c)=>set(el,{transition:`filter ${c.duration}ms ${c.ease},opacity ${c.duration}ms ${c.ease}`,filter:'blur(8px)',opacity:'0'})}
    };

    function animateUnits(units, fx, cfg, orderer){
      const order = (orderer||((a)=>a.map((_,i)=>i)))(units);
      order.forEach((idx,seq)=>{
        const el = units[idx];
        fx.prep && fx.prep(el,cfg);
        setTimeout(()=> fx.play && fx.play(el,cfg), seq*(cfg.stagger||0));
      });
    }

    // run on the current preview element only
    const el = ui.previewText;
    const cfg = readConfig(el);
    const orderer = {sequential:orderers.sequential,random:orderers.random,centerOut:orderers.centerOut}[cfg.pattern] || orderers.sequential;
    const units = (cfg.mode==='char'?splitters.char:cfg.mode==='word'?splitters.word:splitters.element)(el);
    animateUnits(units, FX[cfg.type]||FX.fade, cfg, orderer);
    if(cfg.exit!=='none'){
      setTimeout(()=> animateUnits(units, EXITS[cfg.exit]||EXITS.none, cfg, orderer), Math.max(0,cfg.exitDelay||0) + cfg.duration + units.length*cfg.stagger);
    }
  }

  /* ==========================
     Code generation (JS/CSS)
     ========================== */
  const CSS_SNIPPET = `/* === Reveal (base helpers) === */
.reveal-word,.reveal-char{opacity:0;display:inline-block}
.reveal-cursor{display:inline-block;margin-left:2px;opacity:.6}
`;

  // self-contained auto-init engine (no scroll trigger)
  const JS_ENGINE = `/* ==========================================================
Reveal Engine (vanilla JS) — class-based auto-init
Prefix: reveal-
Usage examples:
  <h1 class="reveal-fade reveal-word reveal-up" data-reveal-duration="700" data-reveal-stagger="90">Hello world</h1>
  <p class="reveal-slide reveal-char reveal-down" data-reveal-amount="60">Lorem ipsum</p>
Types: fade | slide | scale | rotate | bounce | blur | clip | underline | shine | desat | type | scramble
Modes: element (default) | reveal-word | reveal-char
Direction: reveal-up | reveal-down | reveal-left | reveal-right
Data overrides: data-reveal-duration, data-reveal-stagger, data-reveal-ease, data-reveal-amount, data-reveal-exit, data-reveal-exit-delay
========================================================== */
(function(){
  const qAll=(s,r=document)=>Array.from(r.querySelectorAll(s));
  const set=(el,st)=>{for(const k in st) el.style[k]=st[k]};
  const px=n=>typeof n==='number'? \`\${n}px\` : n;
  const has=(el,c)=>el.classList.contains(c);

  const splitters={
    element:el=>[el],
    word:el=>{const words=el.textContent.trim().split(/\\s+/);el.innerHTML=words.map(w=>\`<span class="reveal-word">\${w}</span>\`).join(' ');return qAll('.reveal-word',el)},
    char:el=>{const chars=el.textContent.replace(/\\s+/g,' ').split('');el.innerHTML=chars.map(c=>c===' '?' ':'<span class="reveal-char">'+c+'</span>').join('');return qAll('.reveal-char',el)}
  };

  const orderers={
    sequential:a=>a.map((_,i)=>i),
    random:a=>a.map((_,i)=>i).sort(()=>Math.random()-0.5),
    centerOut:a=>{const n=a.length,c=(n-1)/2;return a.map((_,i)=>[Math.abs(i-c),i]).sort((x,y)=>x[0]-y[0]).map(x=>x[1])}
  };

  function readConfig(el){
    const type= has(el,'reveal-fade')?'fade':has(el,'reveal-slide')?'slide':has(el,'reveal-scale')?'scale':has(el,'reveal-rotate')?'rotate':has(el,'reveal-bounce')?'bounce':has(el,'reveal-blur')?'blur':has(el,'reveal-clip')?'clip':has(el,'reveal-underline')?'underline':has(el,'reveal-shine')?'shine':has(el,'reveal-desat')?'desat':has(el,'reveal-type')?'type':has(el,'reveal-scramble')?'scramble':'fade';
    const mode= has(el,'reveal-char')?'char':has(el,'reveal-word')?'word':'element';
    const direction= has(el,'reveal-down')?'down':has(el,'reveal-left')?'left':has(el,'reveal-right')?'right':'up';
    const pattern= has(el,'reveal-center')?'centerOut':has(el,'reveal-random')?'random':'sequential';
    const num=(k,d)=>{const v=el.getAttribute(k);return v==null||v===''||isNaN(+v)?d:+v};
    const str=(k,d)=>el.getAttribute(k) ?? d;
    return {
      type,mode,direction,pattern,
      duration:num('data-reveal-duration',700),
      stagger:num('data-reveal-stagger',90),
      ease:str('data-reveal-ease','ease-out'),
      amount:num('data-reveal-amount',80),
      exit:str('data-reveal-exit','none'),
      exitDelay:num('data-reveal-exit-delay',0)
    };
  }

  const FX={
    fade:{prep:(el,c)=>set(el,{opacity:'0'}),play:(el,c)=>set(el,{transition:\`opacity \${c.duration}ms \${c.ease}\`,opacity:'1'})},
    slide:{prep:(el,c)=>{const m=c.amount;const map={up:\`translateY(\${px(m)})\`,down:\`translateY(-\${px(m)})\`,left:\`translateX(\${px(m)})\`,right:\`translateX(-\${px(m)})\`};set(el,{opacity:'0',transform:map[c.direction]||map.up})},play:(el,c)=>set(el,{transition:\`transform \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease}\`,transform:'translate(0,0)',opacity:'1'})},
    scale:{prep:(el,c)=>set(el,{opacity:'0',transform:'scale(0.85)'}),play:(el,c)=>set(el,{transition:\`transform \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease}\`,transform:'scale(1)',opacity:'1'})},
    rotate:{prep:(el,c)=>set(el,{opacity:'0',transform:\`rotate(\${px(c.amount)}deg)\`}),play:(el,c)=>set(el,{transition:\`transform \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease}\`,transform:'rotate(0)',opacity:'1'})},
    bounce:{prep:(el,c)=>set(el,{opacity:'0',transform:'translateY(28px) scale(0.98)'}),play:(el,c)=>set(el,{transition:\`transform \${c.duration}ms cubic-bezier(0.22,1,0.36,1),opacity \${c.duration}ms \${c.ease}\`,transform:'translateY(0) scale(1)',opacity:'1'})},
    blur:{prep:(el,c)=>set(el,{opacity:'0',filter:'blur(6px)',transform:'translateY(8px)'}),play:(el,c)=>set(el,{transition:\`filter \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease},transform \${c.duration}ms \${c.ease}\`,filter:'blur(0)',opacity:'1',transform:'translateY(0)'})},
    clip:{prep:(el,c)=>{el.style.overflow='hidden';el.style.position='relative';const axis=(c.direction==='left'||c.direction==='right')?'X':'Y';const w=document.createElement('span');w.style.display='inline-block';w.style.clipPath=axis==='X'?'inset(0 100% 0 0)':'inset(100% 0 0 0)';w.append(...Array.from(el.childNodes));el.appendChild(w);el.__clip=w},play:(el,c)=>{const w=el.__clip;if(!w)return;w.style.transition=\`clip-path \${c.duration}ms \${c.ease}\`;w.style.clipPath='inset(0 0 0 0)'}},
    underline:{prep:(el,c)=>{el.style.position='relative';const u=document.createElement('span');Object.assign(u.style,{position:'absolute',left:0,right:0,bottom:'-2px',height:'2px',background:'currentColor',transform:'scaleX(0)',transformOrigin:'left',opacity:'.9'});u.className='__underline';el.appendChild(u)},play:(el,c)=>{const u=el.querySelector('.__underline');if(u){u.style.transition=\`transform \${c.duration}ms \${c.ease}\`;u.style.transform='scaleX(1)'}}},
    shine:{prep:(el,c)=>{el.style.position='relative';el.style.overflow='hidden';const g=document.createElement('span');Object.assign(g.style,{position:'absolute',top:0,bottom:0,width:'80px',background:'linear-gradient(120deg,transparent,rgba(255,255,255,.35),transparent)',transform:'translateX(-120%)'});g.className='__shine';el.appendChild(g)},play:(el,c)=>{const g=el.querySelector('.__shine');if(g){g.style.transition=\`transform \${c.duration}ms \${c.ease}\`;g.style.transform='translateX(180%)'}}},
    desat:{prep:(el,c)=>set(el,{filter:'saturate(0) contrast(0.9) brightness(1.05)',opacity:'.7'}),play:(el,c)=>set(el,{transition:\`filter \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease}\`,filter:'saturate(1) contrast(1) brightness(1)',opacity:'1'})},
    type:{prep:(el,c)=>{const t=el.textContent;el.textContent='';el.__tw=t;const cur=document.createElement('span');cur.textContent='▍';cur.className='reveal-cursor';el.appendChild(cur)},play:async(el,c)=>{const t=el.__tw||'';const holder=document.createTextNode('');el.firstChild.before(holder);const tick=()=>new Promise(r=>requestAnimationFrame(r));for(let i=0;i<t.length;i++){holder.textContent+=t[i];await tick();if(c.stagger>0)await new Promise(r=>setTimeout(r,Math.max(0,c.stagger/4)))}const cur=el.querySelector('.reveal-cursor');cur&&cur.remove()}},
    scramble:{prep:(el,c)=>{const fin=el.textContent;el.textContent='';const pool="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@$%#";const spans=fin.split('').map(ch=>{const s=document.createElement('span');s.textContent=ch===' ' ? ' ' : '';s.dataset.final=ch;s.style.display='inline-block';s.style.minWidth='0.5ch';return s});spans.forEach(s=>el.appendChild(s));el.__scr=spans;el.__pool=pool},play:async(el,c)=>{const d=c.duration,steps=Math.max(8,Math.floor(d/50));for(let k=0;k<steps;k++){el.__scr.forEach(s=>{if(s.dataset.final===' ')return;s.textContent=Math.random()<(k/steps)?s.dataset.final:el.__pool[Math.floor(Math.random()*el.__pool.length)]});await new Promise(r=>setTimeout(r,Math.max(16,d/steps)))}el.__scr.forEach(s=>s.textContent=s.dataset.final)}}
  };

  const EXITS={
    none:{play(){}},
    fadeOut:{play:(el,c)=>set(el,{transition:\`opacity \${c.duration}ms \${c.ease}\`,opacity:'0'})},
    slideOut:{play:(el,c)=>{const m=c.amount;const map={up:\`translateY(-\${px(m)})\`,down:\`translateY(\${px(m)})\`,left:\`translateX(-\${px(m)})\`,right:\`translateX(\${px(m)})\`};set(el,{transition:\`transform \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease}\`,transform:map[c.direction]||map.up,opacity:'0'})}},
    shrinkOut:{play:(el,c)=>set(el,{transition:\`transform \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease}\`,transform:'scale(0.85)',opacity:'0'})},
    dissolveOut:{play:(el,c)=>set(el,{transition:\`filter \${c.duration}ms \${c.ease},opacity \${c.duration}ms \${c.ease}\`,filter:'blur(8px)',opacity:'0'})}
  };

  function animateUnits(units, fx, cfg, orderer){
    const order=(orderer||((a)=>a.map((_,i)=>i)))(units);
    order.forEach((idx,seq)=>{
      const el=units[idx];
      fx.prep && fx.prep(el,cfg);
      setTimeout(()=> fx.play && fx.play(el,cfg), seq*(cfg.stagger||0));
    });
  }

  function runElement(el){
    const cfg=readConfig(el);
    const fx=FX[cfg.type]||FX.fade;
    const ord=orderers[cfg.pattern]||orderers.sequential;
    const units=(cfg.mode==='char'?splitters.char:cfg.mode==='word'?splitters.word:splitters.element)(el);
    animateUnits(units, fx, cfg, ord);
    if(cfg.exit!=='none'){
      setTimeout(()=> animateUnits(units, EXITS[cfg.exit]||EXITS.none, cfg, ord),
        Math.max(0,cfg.exitDelay||0) + cfg.duration + units.length*cfg.stagger);
    }
  }

  function autoInit(){
    const types=['reveal-fade','reveal-slide','reveal-scale','reveal-rotate','reveal-bounce','reveal-blur','reveal-clip','reveal-underline','reveal-shine','reveal-desat','reveal-type','reveal-scramble'];
    const selector=types.map(c=>'.'+c).join(',');
    qAll(selector).forEach(runElement);
  }

  if(document.readyState==='loading') document.addEventListener('DOMContentLoaded', autoInit); else autoInit();
  window.RevealInit=autoInit;
})();`;

  const HOW_TO = `How to use:
1) Paste the CSS block into your site's global CSS (or a CSS embed).
2) Paste the JS block into a Code/HTML widget (footer/head), once per site.
3) Add classes to any element you want to animate:
   - Type: reveal-fade | reveal-slide | reveal-scale | reveal-rotate | reveal-bounce | reveal-blur | reveal-clip | reveal-underline | reveal-shine | reveal-desat | reveal-type | reveal-scramble
   - Mode: reveal-word (per word) or reveal-char (per character). Omit for entire element.
   - Direction (for slide/clip/exit): reveal-up | reveal-down | reveal-left | reveal-right
4) Optional data attributes to override defaults:
   data-reveal-duration="700"
   data-reveal-stagger="90"
   data-reveal-amount="80"
   data-reveal-ease="cubic-bezier(0.22,1,0.36,1)"
   data-reveal-exit="fadeOut|slideOut|shrinkOut|dissolveOut"
   data-reveal-exit-delay="200"
5) Example:
   <h2 class="reveal-slide reveal-word reveal-up" data-reveal-duration="700" data-reveal-stagger="80" data-reveal-amount="60">
     Make it move with one class
   </h2>`;

  function openModal(kind){
    ui.modal.style.display = 'flex';
    ui.modalContent.textContent = (kind==='js' ? JS_ENGINE : kind==='css' ? CSS_SNIPPET : HOW_TO);
    ui.modalCopy.onclick = () => {
      navigator.clipboard.writeText(ui.modalContent.textContent);
      ui.modalCopy.textContent = 'Copied';
      setTimeout(()=> ui.modalCopy.textContent = 'Copy', 1100);
    };
    ui.modalTabs.forEach(t=> t.classList.toggle('is-active', t.dataset.tab===kind));
  }
  ui.modalClose.addEventListener('click', ()=> ui.modal.style.display='none');
  ui.modalTabs.forEach(t=> t.addEventListener('click', ()=> openModal(t.dataset.tab)));
  ui.btnGenerate.addEventListener('click', ()=> openModal('js'));
  </script>
</body>
</html>
